<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Staff Directory - Castle Comms</title>
  
  <!-- Security Headers -->
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  
  <link rel="stylesheet" href="style.css" />
  <style>
    .staff-container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 2rem;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      color: white;
      min-height: auto;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .staff-container.expanded {
      min-height: 80vh;
    }

    .staff-container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent);
      transform: rotate(45deg);
      animation: shimmer 4s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .staff-content {
      position: relative;
      z-index: 2;
    }

    .staff-title {
      text-align: center;
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 3rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      animation: fadeInDown 0.8s ease-out;
    }

    .hierarchy-level {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      gap: 3rem;
      margin-bottom: 2rem;
    }

    .staff-member {
      position: relative;
      margin: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      transform: translateY(20px);
      opacity: 0;
      animation: slideInUp 0.6s ease-out forwards;
    }

    .staff-member.clickable:hover {
      transform: translateY(-10px) scale(1.05);
    }

    .staff-member.clickable:hover .staff-card::before {
      left: 100%;
    }

    .staff-member.clickable:hover .staff-photo {
      border-color: rgba(255,255,255,0.8);
      box-shadow: 0 0 20px rgba(255,255,255,0.3);
    }


    .staff-card {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 20px;
      padding: 1.5rem;
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .staff-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }


    .staff-photo {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      object-position: center top;
      border: 4px solid rgba(255,255,255,0.3);
      background: white;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
    }

    /* Specific positioning for Raksha's photo */
    .staff-photo[alt="Raksha Hercombe"] {
      object-position: center 20%;
    }



    .staff-name {
      font-size: 1.4rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    .staff-title-role {
      font-size: 1rem;
      opacity: 0.9;
      font-style: italic;
    }


    .connection-branch {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: flex-start;
      gap: 2rem;
      margin-top: 1rem;
    }

    .subordinates {
      display: none;
      animation: slideDown 0.5s ease-out;
    }

    .subordinates.show {
      display: block;
    }


    .level-title {
      font-size: 1.2rem;
      font-weight: bold;
      margin: 1rem 0;
      opacity: 0.9;
      text-align: center;
    }

    .back-button {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      padding: 0.5rem 1.5rem;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      display: none;
      position: absolute;
      top: 2rem;
      left: 2rem;
      z-index: 10;
    }

    .back-button.show {
      display: block;
    }

    .back-button:hover {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.5);
      transform: translateY(-2px);
    }

    .manager-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .manager-context {
      display: none;
      animation: slideDown 0.5s ease-out;
    }

    .manager-context.show {
      display: block;
    }

    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideInUp {
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }


    .staff-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 0.6rem;
      margin: 1rem 0 2rem 0;
      flex-wrap: nowrap;
    }

    .action-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      padding: 0.5rem 0.8rem;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      text-decoration: none;
      display: inline-block;
      text-align: center;
      white-space: normal;
      min-width: 90px;
      flex: 1;
      line-height: 1.2;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .action-btn:hover {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.5);
      transform: translateY(-2px);
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 20px;
      padding: 2rem;
      max-width: 650px;
      max-height: 85vh;
      overflow-y: auto;
      position: relative;
      box-shadow: 0 25px 50px rgba(0,0,0,0.4);
      border: 2px solid rgba(255,255,255,0.1);
      margin: 1rem;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: rgba(255,255,255,0.3);
      transform: rotate(90deg);
    }

    .modal-title {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 1.5rem;
      text-align: center;
      border-bottom: 2px solid rgba(255,255,255,0.2);
      padding-bottom: 1rem;
    }

    .modal-section {
      margin-bottom: 1.5rem;
    }

    .modal-section h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: rgba(255,255,255,0.95);
      border-left: 4px solid rgba(255,255,255,0.4);
      padding-left: 1rem;
    }

    .modal-section p, .modal-section ul {
      line-height: 1.7;
      margin-bottom: 1rem;
      font-size: 1rem;
    }

    .modal-section ul {
      padding-left: 1.5rem;
    }

    .modal-section li {
      margin-bottom: 0.5rem;
    }

    .contact-card {
      background: rgba(255,255,255,0.12);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 0.8rem;
      border-left: 4px solid rgba(255,255,255,0.4);
      transition: all 0.3s ease;
    }

    .contact-card:hover {
      background: rgba(255,255,255,0.18);
      transform: translateX(5px);
    }

    .contact-name {
      font-weight: bold;
      font-size: 1.1rem;
      margin-bottom: 0.3rem;
    }

    .contact-info {
      font-size: 0.95rem;
      opacity: 0.9;
      line-height: 1.4;
    }

    /* Copy to clipboard styles */
    .copy-email {
      display: inline-block;
      margin-left: 0.5rem;
      cursor: pointer;
      font-size: 0.9rem;
      opacity: 0.7;
      transition: opacity 0.3s ease;
    }
    
    .copy-email:hover {
      opacity: 1;
    }
    
    .copy-success {
      color: #4ade80;
      font-weight: bold;
    }

    @media screen and (max-width: 768px) {
      .action-buttons {
        gap: 0.5rem;
      }
      
      .action-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.75rem;
        min-width: 100px;
      }
      
      .modal-content {
        margin: 0.5rem;
        padding: 1.5rem;
      }
      
      .modal-title {
        font-size: 1.6rem;
      }
    }

    @media screen and (max-width: 768px) {
      .staff-container {
        margin: 1rem;
        padding: 1rem;
      }
      
      .staff-title {
        font-size: 1.8rem;
        margin-bottom: 2rem;
      }
      
      .staff-photo {
        width: 80px;
        height: 80px;
        background: white;
      }
      
      .staff-card {
        padding: 1rem;
      }
      
      .staff-name {
        font-size: 1.1rem;
      }
      
      .staff-title-role {
        font-size: 0.85rem;
      }
      
      .connection-branch {
        flex-wrap: nowrap;
        justify-content: center;
        gap: 1rem;
      }
      
      .staff-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        max-width: 600px;
      }
      
      .level-title {
        font-size: 1rem;
      }
      
      .hierarchy-level {
        flex-direction: column;
        gap: 1rem;
      }
      
      body {
        overflow-x: auto;
      }
      
      .staff-member {
        min-width: 140px;
      }
    }
  </style>
</head>
<body>

<!-- Background Slideshow -->
<div class="background-slideshow" id="background-slideshow">
  <!-- Images will be injected by JavaScript -->
</div>
  
<header>
  <button id="menu-toggle" class="hamburger">&#9776;</button>
  <h1>Castle Comms</h1>
</header>

<div id="notification-bell" class="notification-bell hidden">
  üîî <span id="notification-count" class="count-badge">0</span>
</div>

<div id="sidebar-container"></div>

<main id="main">
  <div class="staff-container">
    <button class="back-button" id="back-button" onclick="goBack()">‚Üê Back</button>
    <div class="staff-content">
      <h1 class="staff-title" id="staff-title">Company Structure</h1>
      
      <!-- Top Level Leadership -->
      <div class="hierarchy-level">
        <div class="staff-member clickable" data-staff="gary-turpin" style="animation-delay: 0.1s">
          <div class="staff-card">
            <img src="staff/Gary Turpin - Head of Operations Updated.jpg" alt="Gary Turpin" class="staff-photo" />
            <div class="staff-name">Gary Turpin</div>
            <div class="staff-title-role">Head of Operations</div>
            <div class="expand-indicator">‚ñº</div>
          </div>
        </div>
        
        <div class="staff-member clickable" data-staff="matt-king" style="animation-delay: 0.2s">
          <div class="staff-card">
            <img src="staff/Matt King - Head Of Inventory.jpg" alt="Matt King" class="staff-photo" />
            <div class="staff-name">Matt King</div>
            <div class="staff-title-role">Head Of Inventory</div>
            <div class="expand-indicator">‚ñº</div>
          </div>
        </div>
      </div>

      <!-- Gary Turpin's Direct Reports -->
      <div class="subordinates" id="gary-turpin-subordinates">
        <div class="manager-context" id="gary-turpin-context">
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 0.1s">
              <div class="staff-card">
                <img src="staff/Gary Turpin - Head of Operations Updated.jpg" alt="Gary Turpin" class="staff-photo" />
                <div class="staff-name">Gary Turpin</div>
                <div class="staff-title-role">Head of Operations</div>
              </div>
            </div>
          </div>
        </div>
        <div class="connection-branch">
          <div class="staff-member clickable" data-staff="martin-harrison" style="animation-delay: 0.3s">
            <div class="staff-card">
              <img src="staff/Martin Harrison - Head of Manufacturing and QC.jpg" alt="Martin Harrison" class="staff-photo" />
              <div class="staff-name">Martin Harrison</div>
              <div class="staff-title-role">Head of Manufacturing and QC</div>
            </div>
          </div>
        </div>
        
        <div class="connection-branch">
          <div class="staff-member clickable" data-staff="paul-chapman" style="animation-delay: 0.4s">
            <div class="staff-card">
              <img src="staff/Order Processing/Chappie.jpg" alt="Paul Chapman" class="staff-photo" />
              <div class="staff-name">Paul Chapman</div>
              <div class="staff-title-role">Order Processing Manager</div>
            </div>
          </div>
          
          <div class="staff-member clickable" data-staff="stuart-whitehouse" style="animation-delay: 0.5s">
            <div class="staff-card">
              <img src="staff/Stuart Whitehouse - Logistics Manager.jpg" alt="Stuart Whitehouse" class="staff-photo" />
              <div class="staff-name">Stuart Whitehouse</div>
              <div class="staff-title-role">Logistics Manager</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Matt King's Direct Reports -->
      <div class="subordinates" id="matt-king-subordinates">
        <div class="manager-context" id="matt-king-context">
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 0.2s">
              <div class="staff-card">
                <img src="staff/Matt King - Head Of Inventory.jpg" alt="Matt King" class="staff-photo" />
                <div class="staff-name">Matt King</div>
                <div class="staff-title-role">Head Of Inventory</div>
              </div>
            </div>
          </div>
        </div>
        <div class="connection-branch">
          <div class="staff-member clickable" data-staff="martin-sumner" style="animation-delay: 0.6s">
            <div class="staff-card">
              <img src="staff/Martin Sumner - Head Of Stock Control.jpg" alt="Martin Sumner" class="staff-photo" />
              <div class="staff-name">Martin Sumner</div>
              <div class="staff-title-role">Head Of Stock Control</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 0.7s">
            <div class="staff-card">
              <img src="staff/Raksha Hercombe - Halcyon Support Manager.jpg" alt="Raksha Hercombe" class="staff-photo" />
              <div class="staff-name">Raksha Hercombe</div>
              <div class="staff-title-role">Halcyon Support Manager</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 0.8s">
            <div class="staff-card">
              <img src="staff/Alexandra Bradley - Originals Admin.jpg" alt="Alexandra Bradley" class="staff-photo" />
              <div class="staff-name">Alexandra Bradley</div>
              <div class="staff-title-role">Originals Admin</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Paul Chapman's Team -->
      <div class="subordinates" id="paul-chapman-subordinates">
        <div class="manager-context" id="paul-chapman-context">
          <!-- Order Processing Action Buttons -->
          <div class="action-buttons">
            <button class="action-btn" onclick="openModal('roles-modal')">Roles & Responsibilities</button>
            <a href="https://view.pagetiger.com/ibmxza/ReturningPieces.pdf" target="_blank" class="action-btn">Returning Artwork</a>
            <button class="action-btn" onclick="openModal('instructions-modal')">Gallery Instructions</button>
            <a href="https://view.pagetiger.com/ibmxza/ItemStatusesGuide.pdf" target="_blank" class="action-btn">Item Status Codes</a>
            <a href="https://view.pagetiger.com/ibmxza/OrderFlowChart2023.pdf" target="_blank" class="action-btn">Order Statuses</a>
          </div>
          
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 0.3s">
              <div class="staff-card">
                <img src="staff/Order Processing/Chappie.jpg" alt="Paul Chapman" class="staff-photo" />
                <div class="staff-name">Paul Chapman <span class="copy-email" onclick="copyEmail('pchapman@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
                <div class="staff-title-role">Order Processing Manager</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="staff-grid">
          <div class="staff-member" style="animation-delay: 0.9s">
            <div class="staff-card">
              <img src="staff/Order Processing/Jenny.jpg" alt="Jenny Peet" class="staff-photo" />
              <div class="staff-name">Jenny Peet <span class="copy-email" onclick="copyEmail('jpeet@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Senior Order Processing Coordinator</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.0s">
            <div class="staff-card">
              <img src="staff/Order Processing/Gerald.jpg" alt="Gerald Hooper" class="staff-photo" />
              <div class="staff-name">Gerald Hooper <span class="copy-email" onclick="copyEmail('ghooper@castlegalleries.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Senior Order Processing Coordinator</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.1s">
            <div class="staff-card">
              <img src="staff/Order Processing/Katie.jpg" alt="Katie Lewis" class="staff-photo" />
              <div class="staff-name">Katie Lewis <span class="copy-email" onclick="copyEmail('klewis@castlefineart.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Administration Coordinator</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.2s">
            <div class="staff-card">
              <img src="staff/Order Processing/Tara.jpg" alt="Tara Platts" class="staff-photo" />
              <div class="staff-name">Tara Platts <span class="copy-email" onclick="copyEmail('tplatts@castlefineart.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Order Processing Coordinator</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.3s">
            <div class="staff-card">
              <img src="staff/Order Processing/Pip.jpg" alt="Phillippa Beevor-Reid" class="staff-photo" />
              <div class="staff-name">Phillippa Beevor-Reid <span class="copy-email" onclick="copyEmail('pbeevor-reid@castlefineart.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Order Processing Coordinator</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.4s">
            <div class="staff-card">
              <img src="staff/Order Processing/Amelia.jpg" alt="Amelia Rush" class="staff-photo" />
              <div class="staff-name">Amelia Rush <span class="copy-email" onclick="copyEmail('arush@castlefineart.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Order Processing Coordinator</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Stuart Whitehouse's Team -->
      <div class="subordinates" id="stuart-whitehouse-subordinates">
        <div class="manager-context" id="stuart-whitehouse-context">
          <!-- Logistics Action Buttons -->
          <div class="action-buttons">
            <button class="action-btn" onclick="openModal('retail-deliveries-modal')">Retail Deliveries</button>
            <button class="action-btn" onclick="openModal('personal-deliveries-modal')">Personal Deliveries</button>
            <button class="action-btn" onclick="openModal('installations-modal')">Installations</button>
            <button class="action-btn" onclick="openModal('client-viewings-modal')">Client Viewings</button>
          </div>
          
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 0.4s">
              <div class="staff-card">
                <img src="staff/Stuart Whitehouse - Logistics Manager.jpg" alt="Stuart Whitehouse" class="staff-photo" />
                <div class="staff-name">Stuart Whitehouse <span class="copy-email" onclick="copyEmail('swhitehouse@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
                <div class="staff-title-role">Logistics Manager</div>
              </div>
            </div>
          </div>
        </div>
        <div class="staff-grid">
          <div class="staff-member" style="animation-delay: 1.5s">
            <div class="staff-card">
              <img src="staff/Nathan Smethurst - Shipping Supervisor.jpg" alt="Nathan Smethurst" class="staff-photo" />
              <div class="staff-name">Nathan Smethurst <span class="copy-email" onclick="copyEmail('nsmethurst@castlefineart.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Shipping Supervisor</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.6s">
            <div class="staff-card">
              <img src="staff/Olly Clark - Packing Supervisor.jpg" alt="Olly Clark" class="staff-photo" />
              <div class="staff-name">Olly Clark <span class="copy-email" onclick="copyEmail('oclark@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Packing Supervisor</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 1.7s">
            <div class="staff-card">
              <img src="staff/Zara Chaudhry - Logistics Admin Assistant.jpg" alt="Zara Chaudhry" class="staff-photo" />
              <div class="staff-name">Zara Chaudhry <span class="copy-email" onclick="copyEmail('zchaudhry@washingtongren.co.uk', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Logistics Admin Assistant</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Martin Harrison's Team -->
      <div class="subordinates" id="martin-harrison-subordinates">
        <div class="manager-context" id="martin-harrison-context">
          <!-- Manufacturing Action Buttons -->
          <div class="action-buttons">
            <button class="action-btn" onclick="openModal('framing-modal')">Framing</button>
            <button class="action-btn" onclick="openModal('mounting-modal')">Mounting</button>
            <button class="action-btn" onclick="openModal('quality-control-modal')">Quality Control</button>
            <button class="action-btn" onclick="openModal('requests-modal')">Requests</button>
            <button class="action-btn" onclick="openModal('handing-art-modal')">Handing Art</button>
          </div>
          
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 0.5s">
              <div class="staff-card">
                <img src="staff/Martin Harrison - Head of Manufacturing and QC.jpg" alt="Martin Harrison" class="staff-photo" />
                <div class="staff-name">Martin Harrison <span class="copy-email" onclick="copyEmail('mharrison@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
                <div class="staff-title-role">Head of Manufacturing and QC</div>
              </div>
            </div>
          </div>
        </div>
        <div class="connection-branch">
          <div class="staff-member clickable" data-staff="gary-day" style="animation-delay: 1.8s">
            <div class="staff-card">
              <img src="staff/Gary Day - Framing Production Manager.jpg" alt="Gary Day" class="staff-photo" />
              <div class="staff-name">Gary Day <span class="copy-email" onclick="copyEmail('gday@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Framing Production Manager</div>
            </div>
          </div>
        </div>
        
        <div class="connection-branch">
          <div class="staff-member" style="animation-delay: 1.9s">
            <div class="staff-card">
              <img src="staff/Tom Harrison - Senior Mounting Operative.jpg" alt="Tom Harrison" class="staff-photo" />
              <div class="staff-name">Tom Harrison <span class="copy-email" onclick="copyEmail('tharrison@castlefineart.com', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Senior Mounting Operative</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 2.0s">
            <div class="staff-card">
              <img src="staff/Chrissy Hall - Quality Control Supervisor.jpg" alt="Chrissy Hall" class="staff-photo" />
              <div class="staff-name">Chrissy Hall <span class="copy-email" onclick="copyEmail('chall@washingtongreen.co.uk', this)" title="Copy email">üìã</span></div>
              <div class="staff-title-role">Quality Control Supervisor</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Martin Sumner's Team -->
      <div class="subordinates" id="martin-sumner-subordinates">
        <div class="manager-context" id="martin-sumner-context">
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 0.6s">
              <div class="staff-card">
                <img src="staff/Martin Sumner - Head Of Stock Control.jpg" alt="Martin Sumner" class="staff-photo" />
                <div class="staff-name">Martin Sumner</div>
                <div class="staff-title-role">Head Of Stock Control</div>
              </div>
            </div>
          </div>
        </div>
        <div class="staff-grid">
          <div class="staff-member" style="animation-delay: 2.0s">
            <div class="staff-card">
              <img src="staff/Kerry Hinks - Stock Admin Manager.jpg" alt="Kerry Hinks" class="staff-photo" />
              <div class="staff-name">Kerry Hinks</div>
              <div class="staff-title-role">Stock Admin Manager</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 2.1s">
            <div class="staff-card">
              <img src="staff/Adam Hercombe - Warehouse Stock Manager.jpg" alt="Adam Hercombe" class="staff-photo" />
              <div class="staff-name">Adam Hercombe</div>
              <div class="staff-title-role">Warehouse Stock Manager</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gary Day's Team -->
      <div class="subordinates" id="gary-day-subordinates">
        <div class="manager-context" id="gary-day-context">
          <div class="manager-header">
            <div class="staff-member" style="animation-delay: 1.8s">
              <div class="staff-card">
                <img src="staff/Gary Day - Framing Production Manager.jpg" alt="Gary Day" class="staff-photo" />
                <div class="staff-name">Gary Day</div>
                <div class="staff-title-role">Framing Production Manager</div>
              </div>
            </div>
          </div>
        </div>
        <div class="staff-grid">
          <div class="staff-member" style="animation-delay: 2.2s">
            <div class="staff-card">
              <img src="staff/Bill Chand - Framing Supervisor.jpg" alt="Bill Chand" class="staff-photo" />
              <div class="staff-name">Bill Chand</div>
              <div class="staff-title-role">Framing Supervisor</div>
            </div>
          </div>
          
          <div class="staff-member" style="animation-delay: 2.3s">
            <div class="staff-card">
              <img src="staff/Adam Hyde - Framing Supervisor (Cutting Room).jpg" alt="Adam Hyde" class="staff-photo" />
              <div class="staff-name">Adam Hyde</div>
              <div class="staff-title-role">Framing Supervisor (Cutting Room)</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modals -->
  <div class="modal-overlay" id="roles-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('roles-modal')">&times;</button>
      <div class="modal-title">Order Processing Team</div>
      
      <div class="modal-section">
        <p>Please call your assigned coordinator if you need any information on the below:</p>
        <ul>
          <li>Chasing orders or query ETAs for clients</li>
          <li>Framing queries and quotes</li>
          <li>Track pending shipments with couriers</li>
          <li>Customer orders needed on your next van</li>
          <li>Collections from clients</li>
        </ul>
        <p>You can reach the team on <strong>orderprocessingteam@washingtongreen.co.uk</strong></p>
      </div>
      
    </div>
  </div>
  
  <div class="modal-overlay" id="instructions-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('instructions-modal')">&times;</button>
      <div class="modal-title">Gallery Instructions</div>
      
      <div class="modal-section">
        <p><strong>ITEM MARKED AS SOLD</strong> ‚Äì Please make sure any orders sold from the gallery are marked as sold straight away. When item has been marked as sold, please update notes if, for any reason, you can't mark an order as sold.</p>
      </div>
      
      <div class="modal-section">
        <p><strong>FRAMING CODES</strong> ‚Äì Please make sure there is always a framing code on the order. If there are special instructions for a different frame code in notes, when being sent back to H/O please cross out the frame code that is on there and write the correct one on.</p>
      </div>
      
      <div class="modal-section">
        <p><strong>SPECIAL INSTRUCTIONS</strong> ‚Äì Please make sure any special instructions are entered into the order in the box provided.</p>
      </div>
      
      <div class="modal-section">
        <p><strong>PRF FORMS</strong> ‚Äì Please can you make sure there is a frame code on the PRF form and relevant instructions. Please use the correct PRF form and procedure.</p>
      </div>
      
      <div class="modal-section">
        <p><strong>RETURN OF STOCK FOR CUSTOMER ORDERS</strong> ‚Äì When a request comes through to be returned to H/O, this must come back on the next available van delivery and wrapped in good condition.</p>
      </div>
      
      <div class="modal-section">
        <p><strong>LTD FRAMING ORDERS</strong> ‚Äì When booking on these orders, please make sure in special instructions you add as much info as possible (artist, title, edition number, framing code). This will help us to locate orders when being chased.</p>
      </div>
      
      <div class="modal-section">
        <p><strong>ORDER PROCESSING EMAIL</strong> ‚Äì Please send all enquiries to <strong>orderprocessingteam@washingtongreen.co.uk</strong></p>
      </div>
      
      <div class="modal-section">
        <h3>Sending Orders Together</h3>
        <p>We can't guarantee orders will be sent together unless the correct process is followed. This is something we can do on request, but as you can imagine the volume of orders coming through on a daily basis, this is very hard to manage and can easily be missed.</p>
        <p>Please can we ask that if you do have any requests for these, you put a DND date in and clearly state in the comments that you would like these orders to be sent together.</p>
      </div>
    </div>
  </div>
  
  <!-- Logistics Modals -->
  <div class="modal-overlay" id="retail-deliveries-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('retail-deliveries-modal')">&times;</button>
      <div class="modal-title">Gallery Deliveries</div>
      
      <div class="modal-section">
        <h3>Customer Deliveries</h3>
        <p>Galleries receive deliveries once a week on average, on delivery days:</p>
        <ul>
          <li>There should always be enough staff working to ensure that the gallery is covered and the delivery can be taken. Sometimes this may involve assisting with heavy items.</li>
          <li>Space must be created in the stock room so new pieces can be easily stored.</li>
          <li>Ensure that all items promised to other galleries or HO are wrapped and have a Product Return Form attached. It is the gallery team's responsibility to ensure that these go back on the van in a safe condition.</li>
          <li>Before the van driver leaves, one member of staff should take responsibility for checking that all items listed on the delivery note have been delivered.</li>
          <li>Each item should be checked for damage within 2 days of receipt, damages must be reported to Spitfire within this time period.</li>
        </ul>
      </div>
      
      <div class="modal-section">
        <h3>Shipping Costs</h3>
        <ul>
          <li>Free shipping in the UK</li>
          <li>Free shipping into USA</li>
          <li>¬£50.00 into Europe</li>
          <li>¬£120.00 Rest of the world</li>
        </ul>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="personal-deliveries-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('personal-deliveries-modal')">&times;</button>
      <div class="modal-title">Personal Deliveries (PD)</div>
      
      <div class="modal-section">
        <p>We may choose to deliver your client's order for a number of reasons despite the order not being processed for Personal Delivery. To name a few, geographical efficiency, if the art is too big to be couriered and if the art requires glass a priority.</p>
      </div>
      
      <div class="modal-section">
        <p>In this instance a driver will leave spitfire with a loaded van and hand deliver to the door of the client. The driver is also required to take a photo for proof of delivery.</p>
      </div>
      
      <div class="modal-section">
        <p>You can request specific Personal Deliveries by contacting - <strong>InstallationandPD@washingtongreen.co.uk</strong></p>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="installations-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('installations-modal')">&times;</button>
      <div class="modal-title">Installations</div>
      
      <div class="modal-section">
        <p>Installations must be charged at ¬£250 unless authorised by your Regional Director. You may only offer a discount on the installation fee to clients who have purchased a piece over ¬£10,000.</p>
      </div>
      
      <div class="modal-section">
        <p><a href="https://view.pagetiger.com/ibmxza/InstallationRequestFormexample.docx" target="_blank" style="color: #fff; text-decoration: underline;">Click here for an example of how to fill out the installation request form</a></p>
        <p><a href="https://view.pagetiger.com/ibmxza/InstallationRequestForm.docx" target="_blank" style="color: #fff; text-decoration: underline;">Click here for the installation request form</a></p>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="client-viewings-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('client-viewings-modal')">&times;</button>
      <div class="modal-title">Client Viewings / Home Approvals</div>
      
      <div class="modal-section">
        <p>This is a specific request from the gallery to assist sales staff with a client viewing at the home of the client.</p>
      </div>
      
      <div class="modal-section">
        <p>Often additional piece of stock or orders are required to be dealt with at the same time. We manage this by using Monday.com where the relevant team will be able to prepare the product.</p>
      </div>
      
      <div class="modal-section">
        <p>This request, much like that of an install needs to be requested via logistics - <strong>InstallationandPD@washingtongreen.co.uk</strong></p>
      </div>
      
      <div class="modal-section">
        <p>Like an install we need as much accurate information from you to be provided to the install operative to prepare for the job at hand.</p>
      </div>
      
      <div class="modal-section">
        <p>Occasionally if we are unable to support, you may need to make prior arrangements for travel.</p>
      </div>
    </div>
  </div>
  
  <!-- Manufacturing Modals -->
  <div class="modal-overlay" id="framing-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('framing-modal')">&times;</button>
      <div class="modal-title">Framing</div>
      
      <div class="modal-section">
        <p>Framing information will be displayed here.</p>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="mounting-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('mounting-modal')">&times;</button>
      <div class="modal-title">Mounting</div>
      
      <div class="modal-section">
        <p>Mounting information will be displayed here.</p>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="quality-control-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('quality-control-modal')">&times;</button>
      <div class="modal-title">Quality Control</div>
      
      <div class="modal-section">
        <p>Quality Control information will be displayed here.</p>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="requests-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('requests-modal')">&times;</button>
      <div class="modal-title">Requests</div>
      
      <div class="modal-section">
        <p>Requests information will be displayed here.</p>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="handing-art-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('handing-art-modal')">&times;</button>
      <div class="modal-title">Handing Art</div>
      
      <div class="modal-section">
        <p>Handing Art information will be displayed here.</p>
      </div>
    </div>
  </div>
  
</main>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

<!-- Firebase config -->
<script src="firebase-init.js"></script>

<!-- Shared components -->
<script src="shared-components.js"></script>

<!-- Staff Hierarchy Logic -->
<script>
let navigationStack = [];

document.addEventListener('DOMContentLoaded', function() {
  const staffMembers = document.querySelectorAll('.staff-member.clickable');
  
  staffMembers.forEach(member => {
    member.addEventListener('click', function() {
      const staffId = this.dataset.staff;
      const subordinatesId = `${staffId}-subordinates`;
      const subordinates = document.getElementById(subordinatesId);
      
      if (subordinates) {
        const isCurrentlyExpanded = this.classList.contains('expanded');
        
        if (isCurrentlyExpanded) {
          // Collapsing - go back one level
          goBack();
        } else {
          // Expanding - show subordinates with manager context
          expandSection(staffId, subordinates, this);
        }
      }
    });
  });
});

function expandSection(staffId, subordinates, clickedElement) {
  // Save current state to navigation stack
  const currentState = {
    visibleSections: [],
    expandedElements: []
  };
  
  // Store currently visible sections
  document.querySelectorAll('.subordinates.show').forEach(section => {
    currentState.visibleSections.push(section.id);
  });
  
  // Store currently expanded elements
  document.querySelectorAll('.staff-member.expanded').forEach(element => {
    currentState.expandedElements.push(element.dataset.staff);
  });
  
  navigationStack.push(currentState);
  
  // Hide all current sections
  document.querySelectorAll('.subordinates.show').forEach(section => {
    section.classList.remove('show');
  });
  
  // Remove expanded state from all elements
  document.querySelectorAll('.staff-member.expanded').forEach(element => {
    element.classList.remove('expanded');
  });
  
  // Hide top level sections if we're expanding from top level
  const topLevelSection = document.querySelector('.hierarchy-level');
  if (clickedElement.closest('.hierarchy-level')) {
    topLevelSection.style.display = 'none';
  }
  
  // Show the subordinates section with manager context
  subordinates.classList.add('show');
  clickedElement.classList.add('expanded');
  
  // Show the manager context
  const contextId = `${staffId}-context`;
  const context = document.getElementById(contextId);
  if (context) {
    context.classList.add('show');
  }
  
  // Show the back button
  const backButton = document.getElementById('back-button');
  if (backButton) {
    backButton.classList.add('show');
  }
  
  // Add expanded class to container for larger content
  document.querySelector('.staff-container').classList.add('expanded');
  
  // Update title based on the manager clicked
  updateTitle(staffId);
}

function goBack() {
  if (navigationStack.length === 0) {
    // If no navigation history, show everything
    showAllSections();
    return;
  }
  
  const previousState = navigationStack.pop();
  
  // Hide all current sections
  document.querySelectorAll('.subordinates.show').forEach(section => {
    section.classList.remove('show');
  });
  
  // Hide all manager contexts
  document.querySelectorAll('.manager-context.show').forEach(context => {
    context.classList.remove('show');
  });
  
  // Hide back button if returning to top level
  const backButton = document.getElementById('back-button');
  if (navigationStack.length === 0 && backButton) {
    backButton.classList.remove('show');
  }
  
  // Remove expanded state from all elements
  document.querySelectorAll('.staff-member.expanded').forEach(element => {
    element.classList.remove('expanded');
  });
  
  if (navigationStack.length === 0) {
    // Back to top level
    showAllSections();
  } else {
    // Restore previous state
    previousState.visibleSections.forEach(sectionId => {
      const section = document.getElementById(sectionId);
      if (section) {
        section.classList.add('show');
        
        // Show manager context if it exists
        const contextId = sectionId.replace('-subordinates', '-context');
        const context = document.getElementById(contextId);
        if (context) {
          context.classList.add('show');
        }
      }
    });
    
    previousState.expandedElements.forEach(staffId => {
      const element = document.querySelector(`[data-staff="${staffId}"]`);
      if (element) {
        element.classList.add('expanded');
      }
    });
    
    // Keep container expanded if there are visible sections
    if (previousState.visibleSections.length > 0) {
      document.querySelector('.staff-container').classList.add('expanded');
    }
    
    // Update title based on what's currently visible
    if (previousState.expandedElements.length > 0) {
      updateTitle(previousState.expandedElements[previousState.expandedElements.length - 1]);
    }
  }
}

function showAllSections() {
  // Show top level
  const topLevelSection = document.querySelector('.hierarchy-level');
  if (topLevelSection) {
    topLevelSection.style.display = 'flex';
  }
  
  // Hide all subordinate sections
  document.querySelectorAll('.subordinates').forEach(section => {
    section.classList.remove('show');
  });
  
  // Hide all manager contexts
  document.querySelectorAll('.manager-context').forEach(context => {
    context.classList.remove('show');
  });
  
  // Hide back button
  const backButton = document.getElementById('back-button');
  if (backButton) {
    backButton.classList.remove('show');
  }
  
  // Remove expanded state from all elements
  document.querySelectorAll('.staff-member.expanded').forEach(element => {
    element.classList.remove('expanded');
  });
  
  // Remove expanded class from container to make it compact
  document.querySelector('.staff-container').classList.remove('expanded');
  
  // Clear navigation stack
  navigationStack = [];
  
  // Reset title to default
  updateTitle('default');
}

function updateTitle(staffId) {
  const titleElement = document.getElementById('staff-title');
  const titleMap = {
    'paul-chapman': 'Order Processing',
    'martin-harrison': 'Manufacturing and QC',
    'gary-day': 'Framing',
    'martin-sumner': 'Stock Control',
    'stuart-whitehouse': 'Logistics',
    'gary-turpin': 'Operations',
    'matt-king': 'Inventory',
    'default': 'Company Structure'
  };
  
  const newTitle = titleMap[staffId] || titleMap['default'];
  titleElement.textContent = newTitle;
}

// Modal Functions
function openModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) {
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
}

function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) {
    modal.classList.remove('active');
    document.body.style.overflow = 'auto';
  }
}

// Close modal when clicking outside
document.addEventListener('click', function(e) {
  if (e.target.classList.contains('modal-overlay')) {
    const modalId = e.target.id;
    closeModal(modalId);
  }
});

// Close modal with ESC key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const activeModal = document.querySelector('.modal-overlay.active');
    if (activeModal) {
      closeModal(activeModal.id);
    }
  }
});

// Copy email to clipboard function
function copyEmail(email, element) {
  navigator.clipboard.writeText(email).then(function() {
    const originalText = element.innerHTML;
    element.innerHTML = '‚úì';
    element.classList.add('copy-success');
    
    setTimeout(() => {
      element.innerHTML = originalText;
      element.classList.remove('copy-success');
    }, 1500);
  }).catch(function(err) {
    console.error('Could not copy email: ', err);
    // Fallback for older browsers
    const textArea = document.createElement('textarea');
    textArea.value = email;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    
    const originalText = element.innerHTML;
    element.innerHTML = '‚úì';
    element.classList.add('copy-success');
    
    setTimeout(() => {
      element.innerHTML = originalText;
      element.classList.remove('copy-success');
    }, 1500);
  });
}

</script>

<!-- Site scripts -->
<script src="script.js"></script>
</body>
</html>